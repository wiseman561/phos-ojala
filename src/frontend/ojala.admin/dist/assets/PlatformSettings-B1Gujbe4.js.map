{"version":3,"file":"PlatformSettings-B1Gujbe4.js","sources":["../../src/components/settings/PlatformSettings.jsx"],"sourcesContent":["import { useState, useEffect } from 'react';\r\nimport { Switch } from '@headlessui/react';\r\nimport { getSettings, saveSettings, defaultSettings } from '../../utils/settingsStorage';\r\nimport { useAuth } from '../../contexts/AuthContext';\r\nimport { useMaintenanceMode } from '../../hooks/useMaintenanceMode';\r\nimport { toast } from 'react-hot-toast';\r\n\r\nconst roles = [\r\n  { id: 'admin', name: 'Administrator', description: 'Full system access and control' },\r\n  { id: 'provider', name: 'Healthcare Provider', description: 'Access to patient records and scheduling' },\r\n  { id: 'staff', name: 'Staff', description: 'Limited access to assigned tasks and records' },\r\n  { id: 'patient', name: 'Patient', description: 'Access to personal records and appointments' },\r\n];\r\n\r\nconst retentionPeriods = [\r\n  { value: 30, label: '30 days' },\r\n  { value: 60, label: '60 days' },\r\n  { value: 90, label: '90 days' },\r\n];\r\n\r\nfunction classNames(...classes) {\r\n  return classes.filter(Boolean).join(' ');\r\n}\r\n\r\nexport default function PlatformSettings() {\r\n  const { user } = useAuth();\r\n  const { isMaintenanceMode, toggleMaintenanceMode } = useMaintenanceMode();\r\n  const [settings, setSettings] = useState({\r\n    maintenanceMode: false,\r\n    autoExport: false,\r\n    auditLogRetention: 30,\r\n    ...defaultSettings.platform\r\n  });\r\n  const [isSaving, setIsSaving] = useState(false);\r\n  const [saveStatus, setSaveStatus] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    const loadStoredSettings = async () => {\r\n      try {\r\n        const storedSettings = await getSettings('PLATFORM');\r\n        if (storedSettings) {\r\n          setSettings(prev => ({\r\n            ...prev,\r\n            ...storedSettings\r\n          }));\r\n        }\r\n      } catch (error) {\r\n        console.error('Error loading platform settings:', error);\r\n        toast.error('Failed to load platform settings');\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    loadStoredSettings();\r\n  }, []);\r\n\r\n  const handleMaintenanceModeToggle = async (enabled) => {\r\n    try {\r\n      await toggleMaintenanceMode(enabled);\r\n      setSettings(prev => ({\r\n        ...prev,\r\n        maintenanceMode: enabled\r\n      }));\r\n      toast.success(`Maintenance mode ${enabled ? 'enabled' : 'disabled'}`);\r\n    } catch (error) {\r\n      console.error('Error toggling maintenance mode:', error);\r\n      toast.error('Failed to update maintenance mode');\r\n    }\r\n  };\r\n\r\n  const handleAutoExportToggle = async (enabled) => {\r\n    try {\r\n      const updatedSettings = {\r\n        ...settings,\r\n        autoExport: enabled\r\n      };\r\n      const success = await saveSettings('PLATFORM', updatedSettings);\r\n      if (success) {\r\n        setSettings(updatedSettings);\r\n        toast.success(`Auto-export ${enabled ? 'enabled' : 'disabled'}`);\r\n      } else {\r\n        setSaveStatus({ type: 'error', message: 'Failed to save platform settings' });\r\n      }\r\n    } catch (error) {\r\n      console.error('Error updating auto-export setting:', error);\r\n      toast.error('Failed to update auto-export setting');\r\n    }\r\n  };\r\n\r\n  const handleAuditLogRetentionChange = async (days) => {\r\n    try {\r\n      const updatedSettings = {\r\n        ...settings,\r\n        auditLogRetention: days\r\n      };\r\n      const success = await saveSettings('PLATFORM', updatedSettings);\r\n      if (success) {\r\n        setSettings(updatedSettings);\r\n        toast.success('Audit log retention period updated');\r\n      } else {\r\n        setSaveStatus({ type: 'error', message: 'Failed to save platform settings' });\r\n      }\r\n    } catch (error) {\r\n      console.error('Error updating audit log retention:', error);\r\n      toast.error('Failed to update audit log retention period');\r\n    }\r\n  };\r\n\r\n  const handleSave = async () => {\r\n    setIsSaving(true);\r\n    setSaveStatus(null);\r\n\r\n    try {\r\n      const success = await saveSettings('PLATFORM', settings);\r\n      if (success) {\r\n        setSaveStatus({ type: 'success', message: 'Platform settings saved successfully' });\r\n      } else {\r\n        setSaveStatus({ type: 'error', message: 'Failed to save platform settings' });\r\n      }\r\n    } catch (error) {\r\n      setSaveStatus({ type: 'error', message: 'An error occurred while saving settings' });\r\n    } finally {\r\n      setIsSaving(false);\r\n    }\r\n  };\r\n\r\n  // Only render if user is admin\r\n  if (user?.role !== 'admin') {\r\n    return (\r\n      <div className=\"p-4 text-center\">\r\n        <h3 className=\"text-lg font-medium text-gray-900 dark:text-white mb-2\">Access Denied</h3>\r\n        <p className=\"text-gray-500 dark:text-gray-400\">\r\n          You do not have permission to access platform controls.\r\n        </p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"p-4 text-center\">\r\n        <div className=\"animate-pulse\">\r\n          <div className=\"h-4 bg-gray-200 dark:bg-gray-700 rounded w-3/4 mx-auto mb-4\"></div>\r\n          <div className=\"h-4 bg-gray-200 dark:bg-gray-700 rounded w-1/2 mx-auto\"></div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <div>\r\n        <h3 className=\"text-lg font-medium leading-6 text-gray-900 dark:text-white\">Platform Controls</h3>\r\n        <p className=\"mt-1 text-sm text-gray-500 dark:text-gray-400\">\r\n          Manage platform-wide settings and maintenance mode.\r\n        </p>\r\n      </div>\r\n\r\n      <div className=\"space-y-6\">\r\n        {/* Maintenance Mode */}\r\n        <div className=\"flex items-center justify-between\">\r\n          <div className=\"flex-grow\">\r\n            <h4 className=\"text-sm font-medium text-gray-900 dark:text-white\">Maintenance Mode</h4>\r\n            <p className=\"text-sm text-gray-500 dark:text-gray-400\">\r\n              Enable to restrict access to non-admin users\r\n            </p>\r\n          </div>\r\n          <Switch\r\n            checked={isMaintenanceMode}\r\n            onChange={handleMaintenanceModeToggle}\r\n            className={classNames(\r\n              isMaintenanceMode ? 'bg-blue-600' : 'bg-gray-200 dark:bg-gray-700',\r\n              'relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2'\r\n            )}\r\n          >\r\n            <span\r\n              className={classNames(\r\n                isMaintenanceMode ? 'translate-x-5' : 'translate-x-0',\r\n                'pointer-events-none relative inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out'\r\n              )}\r\n            />\r\n          </Switch>\r\n        </div>\r\n\r\n        {/* Role Management */}\r\n        <div>\r\n          <h4 className=\"text-sm font-medium text-gray-900 dark:text-white mb-4\">Role Management</h4>\r\n          <div className=\"overflow-hidden shadow ring-1 ring-black ring-opacity-5 sm:rounded-lg\">\r\n            <table className=\"min-w-full divide-y divide-gray-300 dark:divide-gray-700\">\r\n              <thead className=\"bg-gray-50 dark:bg-gray-800\">\r\n                <tr>\r\n                  <th className=\"py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 dark:text-white sm:pl-6\">\r\n                    Role\r\n                  </th>\r\n                  <th className=\"px-3 py-3.5 text-left text-sm font-semibold text-gray-900 dark:text-white\">\r\n                    Description\r\n                  </th>\r\n                  <th className=\"px-3 py-3.5 text-left text-sm font-semibold text-gray-900 dark:text-white\">\r\n                    Status\r\n                  </th>\r\n                </tr>\r\n              </thead>\r\n              <tbody className=\"divide-y divide-gray-200 dark:divide-gray-700 bg-white dark:bg-gray-900\">\r\n                {roles.map((role) => (\r\n                  <tr key={role.id}>\r\n                    <td className=\"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 dark:text-white sm:pl-6\">\r\n                      {role.name}\r\n                    </td>\r\n                    <td className=\"whitespace-nowrap px-3 py-4 text-sm text-gray-500 dark:text-gray-400\">\r\n                      {role.description}\r\n                    </td>\r\n                    <td className=\"whitespace-nowrap px-3 py-4 text-sm text-gray-500 dark:text-gray-400\">\r\n                      Active\r\n                    </td>\r\n                  </tr>\r\n                ))}\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Data Export Preferences */}\r\n        <div>\r\n          <h4 className=\"text-sm font-medium text-gray-900 dark:text-white mb-4\">Data Export Preferences</h4>\r\n          <div className=\"flex items-center justify-between\">\r\n            <div className=\"flex-grow\">\r\n              <p className=\"text-sm text-gray-500 dark:text-gray-400\">\r\n                Automatically export data to CSV format\r\n              </p>\r\n            </div>\r\n            <Switch\r\n              checked={settings.autoExport}\r\n              onChange={handleAutoExportToggle}\r\n              className={classNames(\r\n                settings.autoExport ? 'bg-blue-600' : 'bg-gray-200 dark:bg-gray-700',\r\n                'relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2'\r\n              )}\r\n            >\r\n              <span\r\n                className={classNames(\r\n                  settings.autoExport ? 'translate-x-5' : 'translate-x-0',\r\n                  'pointer-events-none relative inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out'\r\n                )}\r\n              />\r\n            </Switch>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Audit Log Retention */}\r\n        <div>\r\n          <h4 className=\"text-sm font-medium text-gray-900 dark:text-white mb-4\">Audit Log Retention</h4>\r\n          <select\r\n            value={settings.auditLogRetention}\r\n            onChange={(e) => handleAuditLogRetentionChange(Number(e.target.value))}\r\n            className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:border-gray-600 dark:text-white\"\r\n          >\r\n            {retentionPeriods.map((period) => (\r\n              <option key={period.value} value={period.value}>\r\n                {period.label}\r\n              </option>\r\n            ))}\r\n          </select>\r\n        </div>\r\n\r\n        {/* Save Button */}\r\n        <div className=\"flex justify-end\">\r\n          <button\r\n            type=\"button\"\r\n            onClick={handleSave}\r\n            disabled={isSaving}\r\n            className=\"inline-flex justify-center rounded-md border border-transparent bg-blue-600 py-2 px-4 text-sm font-medium text-white shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n          >\r\n            {isSaving ? 'Saving...' : 'Save Changes'}\r\n          </button>\r\n        </div>\r\n\r\n        {/* Status Message */}\r\n        {saveStatus && (\r\n          <div\r\n            className={`mt-4 p-4 rounded-md ${\r\n              saveStatus.type === 'success'\r\n                ? 'bg-green-50 text-green-800 dark:bg-green-900 dark:text-green-200'\r\n                : 'bg-red-50 text-red-800 dark:bg-red-900 dark:text-red-200'\r\n            }`}\r\n          >\r\n            {saveStatus.message}\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":["roles","retentionPeriods","classNames","classes","PlatformSettings","user","useAuth","isMaintenanceMode","toggleMaintenanceMode","useMaintenanceMode","settings","setSettings","useState","defaultSettings","isSaving","setIsSaving","saveStatus","setSaveStatus","loading","setLoading","useEffect","storedSettings","getSettings","prev","error","toast","handleMaintenanceModeToggle","enabled","handleAutoExportToggle","updatedSettings","saveSettings","handleAuditLogRetentionChange","days","handleSave","success","jsxs","jsx","Switch","role","e","period"],"mappings":"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"}